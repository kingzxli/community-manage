<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.community.mapper.BillMapper">

	<select id="selectBill" resultType="com.community.entity.vo.BillVo" parameterType="com.community.entity.vo.BillVo">
		SELECT
			a.id,
			a.bill_year,
			a.bill_amount,
			a.pay_amount,
			a.pay_status,
			a.remark,
			a.pay_wx_id,
			a.pay_phone,
			a.pay_name,
			e.community_name,
			e.community_address,
			d.build_name,
			c.unit,
			b.room,
			b.area,
			b.type 
		FROM
			bill a
			LEFT JOIN room b ON a.room_id = b.id
			LEFT JOIN unit c ON b.unit_id = c.id
			LEFT JOIN build d ON c.build_id = d.id
			LEFT JOIN community e ON d.community_id = e.id 
		WHERE
			a.is_delete = 0
		<if test="billYear != null and billYear != '' ">			
			AND a.bill_year like concat('%',#{billYear},'%')
		</if>
		<if test="payWxId != null and payWxId != '' ">			
			AND a.pay_wx_id = #{payWxId}
		</if>
		<if test="payPhone != null and payPhone != '' ">			
			AND a.pay_phone like concat('%',#{payPhone},'%')
		</if>
		<if test="payName != null and payName != '' ">			
			AND a.pay_name like concat('%',#{payName},'%')
		</if>
		<if test="communityId != null and communityId != '' ">			
			AND d.community_id = #{communityId}
		</if>
		<if test="buildId != null and buildId != '' ">			
			AND c.build_id = #{buildId}
		</if>
		<if test="unitId != null and unitId != '' ">			
			AND b.unit_id = #{unitId}
		</if>
		<if test="roomId != null and roomId != '' ">			
			AND a.room_id = #{roomId}
		</if>
		ORDER BY a.created_time desc
	</select>

</mapper>
	
	
	
	
	